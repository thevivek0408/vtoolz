<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Pong</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#0a0a0a;color:#e0e0e0;font-family:'Segoe UI',Arial,sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:8px;user-select:none;overflow:hidden}
h1{font-size:1.4rem;margin-bottom:4px;color:#0f0;text-shadow:0 0 20px #00ff0044;font-family:'Courier New',monospace}
canvas{display:block;border:1px solid #00ff0033;border-radius:4px}
.info{display:flex;gap:20px;margin-bottom:6px;font-size:.85rem;color:#0f0}
.controls{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap;justify-content:center}
.controls button{background:#111;border:1px solid #00ff0033;color:#0f0;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:.85rem;font-family:'Courier New',monospace}
.controls button:hover,.controls button.active{background:#00ff0022;border-color:#0f0}
</style>
</head>
<body>
<h1>PONG</h1>
<div class="info">
  <span id="mode-label">vs AI (Medium)</span>
</div>
<canvas id="c"></canvas>
<div class="controls">
  <button onclick="setMode('easy')" id="m-easy">Easy AI</button>
  <button onclick="setMode('medium')" id="m-medium" class="active">Medium AI</button>
  <button onclick="setMode('hard')" id="m-hard">Hard AI</button>
  <button onclick="setMode('pvp')" id="m-pvp">2 Player</button>
  <button onclick="startGame()">Restart</button>
</div>
<script>
const canvas=document.getElementById('c'),ctx=canvas.getContext('2d');
let W,H,scale;
function resize(){
  W=600;H=400;
  scale=Math.min((window.innerWidth-16)/W,(window.innerHeight-130)/H,1.5);
  canvas.width=W;canvas.height=H;
  canvas.style.width=Math.floor(W*scale)+'px';canvas.style.height=Math.floor(H*scale)+'px';
}
resize();window.addEventListener('resize',resize);

const PADDLE_W=12,PADDLE_H=70,BALL_R=8,WIN_SCORE=11;
let mode='medium',p1,p2,ball,particles,gameRunning,keys={};
const AI_SPEED={easy:2.5,medium:4,hard:6};

function setMode(m){
  mode=m;
  document.querySelectorAll('.controls button').forEach(b=>b.classList.remove('active'));
  document.getElementById('m-'+m).classList.add('active');
  document.getElementById('mode-label').textContent=m==='pvp'?'2 Player':'vs AI ('+m.charAt(0).toUpperCase()+m.slice(1)+')';
  startGame();
}
function startGame(){
  p1={x:20,y:H/2-PADDLE_H/2,score:0,speed:6};
  p2={x:W-20-PADDLE_W,y:H/2-PADDLE_H/2,score:0,speed:6};
  particles=[];
  resetBall();
  gameRunning=true;
  loop();
}
function resetBall(){
  ball={x:W/2,y:H/2,dx:(Math.random()>.5?1:-1)*5,dy:(Math.random()-.5)*4,r:BALL_R,trail:[]};
}
function loop(){
  if(!gameRunning)return;
  update();draw();
  requestAnimationFrame(loop);
}
function update(){
  // Player 1 (W/S or touch)
  if(keys.w)p1.y-=p1.speed;
  if(keys.s)p1.y+=p1.speed;
  p1.y=Math.max(0,Math.min(H-PADDLE_H,p1.y));
  // Player 2 or AI
  if(mode==='pvp'){
    if(keys.up)p2.y-=p2.speed;
    if(keys.down)p2.y+=p2.speed;
  } else {
    let target=ball.y-PADDLE_H/2;
    let speed=AI_SPEED[mode];
    // Add prediction based on difficulty
    if(mode==='hard'&&ball.dx>0){
      let timeToReach=(p2.x-ball.x)/Math.abs(ball.dx);
      target=ball.y+ball.dy*timeToReach-PADDLE_H/2;
    }
    if(mode==='easy')target+=Math.sin(Date.now()/200)*20; // wobble
    let diff=target-p2.y;
    if(Math.abs(diff)>speed)p2.y+=Math.sign(diff)*speed;
    else p2.y=target;
  }
  p2.y=Math.max(0,Math.min(H-PADDLE_H,p2.y));
  // Ball trail
  ball.trail.push({x:ball.x,y:ball.y});
  if(ball.trail.length>12)ball.trail.shift();
  // Ball movement
  ball.x+=ball.dx;ball.y+=ball.dy;
  // Top/bottom walls
  if(ball.y-ball.r<0){ball.y=ball.r;ball.dy*=-1}
  if(ball.y+ball.r>H){ball.y=H-ball.r;ball.dy*=-1}
  // Paddle collisions
  if(ball.dx<0&&ball.x-ball.r<=p1.x+PADDLE_W&&ball.x-ball.r>=p1.x&&ball.y>=p1.y&&ball.y<=p1.y+PADDLE_H){
    ball.dx=Math.abs(ball.dx)*1.05;
    let hit=(ball.y-(p1.y+PADDLE_H/2))/(PADDLE_H/2);
    ball.dy=hit*6;ball.x=p1.x+PADDLE_W+ball.r;
    addParticles(ball.x,ball.y,'#0f0');
  }
  if(ball.dx>0&&ball.x+ball.r>=p2.x&&ball.x+ball.r<=p2.x+PADDLE_W&&ball.y>=p2.y&&ball.y<=p2.y+PADDLE_H){
    ball.dx=-Math.abs(ball.dx)*1.05;
    let hit=(ball.y-(p2.y+PADDLE_H/2))/(PADDLE_H/2);
    ball.dy=hit*6;ball.x=p2.x-ball.r;
    addParticles(ball.x,ball.y,'#0f0');
  }
  // Speed cap
  let maxSpeed=12;
  if(Math.abs(ball.dx)>maxSpeed)ball.dx=Math.sign(ball.dx)*maxSpeed;
  // Scoring
  if(ball.x<-20){p2.score++;addParticles(0,ball.y,'#f00');afterScore()}
  if(ball.x>W+20){p1.score++;addParticles(W,ball.y,'#f00');afterScore()}
  // Particles
  particles.forEach(p=>{p.x+=p.dx;p.y+=p.dy;p.life--;p.dy+=.1});
  particles=particles.filter(p=>p.life>0);
}
function afterScore(){
  resetBall();
  if(p1.score>=WIN_SCORE||p2.score>=WIN_SCORE){gameRunning=false;drawWin()}
}
function addParticles(x,y,color){
  for(let i=0;i<8;i++)particles.push({x,y,dx:(Math.random()-.5)*6,dy:(Math.random()-.5)*6,life:20,color});
}
function draw(){
  ctx.fillStyle='#0a0a0a';ctx.fillRect(0,0,W,H);
  // Center line
  ctx.setLineDash([8,8]);ctx.strokeStyle='#00ff0033';ctx.lineWidth=2;
  ctx.beginPath();ctx.moveTo(W/2,0);ctx.lineTo(W/2,H);ctx.stroke();ctx.setLineDash([]);
  // Scores
  ctx.fillStyle='#00ff0044';ctx.font='bold 80px Courier New';ctx.textAlign='center';
  ctx.fillText(p1.score,W/4,80);ctx.fillText(p2.score,3*W/4,80);
  // Ball trail
  ball.trail.forEach((t,i)=>{
    let a=i/ball.trail.length;
    ctx.fillStyle=`rgba(0,255,0,${a*.2})`;
    ctx.beginPath();ctx.arc(t.x,t.y,ball.r*a,0,Math.PI*2);ctx.fill();
  });
  // Ball
  let bg=ctx.createRadialGradient(ball.x-2,ball.y-2,1,ball.x,ball.y,ball.r);
  bg.addColorStop(0,'#fff');bg.addColorStop(1,'#0f0');
  ctx.fillStyle=bg;
  ctx.beginPath();ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);ctx.fill();
  ctx.shadowColor='#0f0';ctx.shadowBlur=15;
  ctx.fill();ctx.shadowBlur=0;
  // Paddles
  drawPaddle(p1);drawPaddle(p2);
  // Particles
  particles.forEach(p=>{ctx.globalAlpha=p.life/20;ctx.fillStyle=p.color;ctx.fillRect(p.x-2,p.y-2,4,4)});
  ctx.globalAlpha=1;
}
function drawPaddle(p){
  let g=ctx.createLinearGradient(p.x,p.y,p.x,p.y+PADDLE_H);
  g.addColorStop(0,'#0f0');g.addColorStop(.5,'#0a0');g.addColorStop(1,'#0f0');
  ctx.fillStyle=g;
  ctx.shadowColor='#0f0';ctx.shadowBlur=10;
  ctx.beginPath();ctx.roundRect(p.x,p.y,PADDLE_W,PADDLE_H,4);ctx.fill();
  ctx.shadowBlur=0;
}
function drawWin(){
  ctx.fillStyle='rgba(0,0,0,.7)';ctx.fillRect(0,0,W,H);
  ctx.fillStyle='#0f0';ctx.font='bold 32px Courier New';ctx.textAlign='center';
  let winner=p1.score>=WIN_SCORE?(mode==='pvp'?'Player 1':'You'):(mode==='pvp'?'Player 2':'AI');
  ctx.fillText(winner+' Wins!',W/2,H/2-10);
  ctx.font='16px Courier New';ctx.fillText(`${p1.score} - ${p2.score}`,W/2,H/2+25);
}
// Input
document.addEventListener('keydown',e=>{
  if(e.key==='w'||e.key==='W')keys.w=true;
  if(e.key==='s'||e.key==='S')keys.s=true;
  if(e.key==='ArrowUp'){e.preventDefault();keys.up=true}
  if(e.key==='ArrowDown'){e.preventDefault();keys.down=true}
});
document.addEventListener('keyup',e=>{
  if(e.key==='w'||e.key==='W')keys.w=false;
  if(e.key==='s'||e.key==='S')keys.s=false;
  if(e.key==='ArrowUp')keys.up=false;
  if(e.key==='ArrowDown')keys.down=false;
});
// Touch: left half controls P1, right half controls P2 (or ignored in AI mode)
canvas.addEventListener('touchmove',e=>{
  e.preventDefault();
  let r=canvas.getBoundingClientRect();
  for(let t of e.touches){
    let y=(t.clientY-r.top)/scale-PADDLE_H/2;
    let x=(t.clientX-r.left)/scale;
    if(x<W/2)p1.y=y;
    else if(mode==='pvp')p2.y=y;
    else p1.y=y;
  }
},{passive:false});
startGame();
</script>
</body>
</html>
